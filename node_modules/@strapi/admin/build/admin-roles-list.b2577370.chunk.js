"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[3455],{67249:function(N,M,t){t.r(M),t.d(M,{default:function(){return me}});var e=t(32735),n=t(69262),f=t(83983),x=t(47765),O=t(68625),W=t(4038),j=t(19406),B=t(27649),U=t(82055),g=t(41415),S=t(99223),F=t(17e3),Q=t(56755),z=t(73269),X=t(33827),k=t(94547),v=t(19786),P=t(49372),G=t(3685),J=t(35658),Y=t(33795),w=t.n(Y),I=t(67879),q=t(53038),_=t(32308),ee=()=>"todo empty role",te=t(60216),L=t.n(te),ne=t(87933),le=t(72850),se=t(50563);const K=({id:a,name:o,description:l,usersCount:E,icons:r,rowIndex:u,canUpdate:h})=>{const{formatMessage:C}=(0,I.Z)(),[,i]=r,R=C({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:E});return e.createElement(k.Tr,{"aria-rowindex":u,key:a,...h?(0,n.X7)({fn:i.onClick}):{}},e.createElement(v.Td,{maxWidth:(0,n.Q1)(130)},e.createElement(P.Z,{ellipsis:!0,textColor:"neutral800"},o)),e.createElement(v.Td,{maxWidth:(0,n.Q1)(250)},e.createElement(P.Z,{ellipsis:!0,textColor:"neutral800"},l)),e.createElement(v.Td,null,e.createElement(P.Z,{textColor:"neutral800"},R)),e.createElement(v.Td,null,e.createElement(ne.k,{justifyContent:"flex-end",...n.UW},r.map((d,D)=>d?e.createElement(le.x,{key:d.label,paddingLeft:D===0?0:1},e.createElement(se.h,{onClick:d.onClick,label:d.label,noBorder:!0,icon:d.icon})):null))))};K.propTypes={id:L().number.isRequired,name:L().string.isRequired,description:L().string.isRequired,usersCount:L().number.isRequired,icons:L().array.isRequired,rowIndex:L().number.isRequired,canUpdate:L().bool},K.defaultProps={canUpdate:!1};var ae=K,oe=t(97889);const re={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1};var ie=(a,o)=>(0,oe.ZP)(a,l=>{switch(o.type){case"ON_REMOVE_ROLES":{l.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{l.shouldRefetchData=!0,l.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{l.shouldRefetchData=!1,l.roleToDelete=null,l.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{l.roleToDelete=o.id;break}default:return l}});const de=()=>{(0,n.go)();const{locale:a}=(0,I.Z)(),{isLoading:o,allowedActions:{canCreate:l,canDelete:E,canRead:r,canUpdate:u}}=(0,n.ss)(f.Z.settings.roles),{getData:h,roles:C,isLoading:i}=(0,_.bF)(!1),[{query:R}]=(0,n.Kx)(),d=R?._q||"",{includes:D}=(0,n.L0)(a,{sensitivity:"base"}),T=(0,n.Xe)(a,{sensitivity:"base"}),A=(C||[]).filter(p=>D(p.name,d)||D(p.description,d)).sort((p,y)=>T.compare(p.name,y.name)||T.compare(p.description,y.description));return(0,e.useEffect)(()=>{!o&&r&&h()},[o,r,h]),{isLoadingForPermissions:o,canCreate:l,canDelete:E,canRead:r,canUpdate:u,isLoading:i,getData:h,sortedRoles:A,roles:C}},ce=({getData:a,canCreate:o,canDelete:l,canUpdate:E})=>{const{formatMessage:r}=(0,I.Z)(),u=(0,n.lm)(),[h,C]=(0,e.useState)(!1),{push:i}=(0,q.k6)(),[{selectedRoles:R,showModalConfirmButtonLoading:d,roleToDelete:D},T]=(0,e.useReducer)(ie,re),{post:A}=(0,n.tg)(),p=async()=>{try{T({type:"ON_REMOVE_ROLES"}),await A("/admin/roles/batch-delete",{ids:[D]}),await a(),T({type:"RESET_DATA_TO_DELETE"})}catch(s){const c=w()(s,["response","payload","data","ids"],null);if(c&&Array.isArray(c)){const Ee=c.join(`
`);u({type:"warning",message:Ee})}else u({type:"warning",message:{id:"notification.error"}})}m()},y=(0,e.useCallback)(s=>{i(`/settings/roles/duplicate/${s}`)},[i]),$=()=>i("/settings/roles/new"),Z=(0,e.useCallback)(s=>{T({type:"SET_ROLE_TO_DELETE",id:s}),m()},[]),m=()=>C(s=>!s),b=(0,e.useCallback)(s=>{i(`/settings/roles/${s}`)},[i]),V=(0,e.useCallback)((s,c)=>{s.preventDefault(),s.stopPropagation(),c.usersCount?u({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):Z(c.id)},[u,Z]),H=(0,e.useCallback)((s,c)=>{s.preventDefault(),s.stopPropagation(),y(c.id)},[y]),ge=(0,e.useCallback)(s=>[...o?[{onClick:c=>H(c,s),label:r({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(x.Z,null)}]:[],...E?[{onClick:()=>b(s.id),label:r({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(O.Z,null)}]:[],...l?[{onClick:c=>V(c,s),label:r({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(W.Z,null)}]:[]],[r,V,H,b,o,E,l]);return{handleNewRoleClick:$,getIcons:ge,selectedRoles:R,isWarningDeleteAllOpened:h,showModalConfirmButtonLoading:d,handleToggleModal:m,handleDeleteData:p}};var ue=()=>{const{formatMessage:a}=(0,I.Z)(),{isLoadingForPermissions:o,canCreate:l,canRead:E,canDelete:r,canUpdate:u,isLoading:h,getData:C,sortedRoles:i}=de(),{handleNewRoleClick:R,getIcons:d,isWarningDeleteAllOpened:D,showModalConfirmButtonLoading:T,handleToggleModal:A,handleDeleteData:p}=ce({getData:C,canCreate:l,canDelete:r,canUpdate:u}),y=i.length+1,$=6;if(o)return e.createElement(B.o,null,e.createElement(n.dO,null));const Z=a({id:"global.roles",defaultMessage:"roles"});return e.createElement(B.o,null,e.createElement(n.SL,{name:"Roles"}),e.createElement(U.T,{primaryAction:l?e.createElement(g.z,{onClick:R,startIcon:e.createElement(j.Z,null),size:"S"},a({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:Z,subtitle:a({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),E&&e.createElement(S.Z,{startActions:e.createElement(n.m,{label:a({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:Z})})}),E&&e.createElement(F.D,null,e.createElement(Q.i,{colCount:$,rowCount:y,footer:l?e.createElement(z.c,{onClick:R,icon:e.createElement(j.Z,null)},a({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(X.h,null,e.createElement(k.Tr,{"aria-rowindex":1},e.createElement(v.Th,null,e.createElement(P.Z,{variant:"sigma",textColor:"neutral600"},a({id:"global.name",defaultMessage:"Name"}))),e.createElement(v.Th,null,e.createElement(P.Z,{variant:"sigma",textColor:"neutral600"},a({id:"global.description",defaultMessage:"Description"}))),e.createElement(v.Th,null,e.createElement(P.Z,{variant:"sigma",textColor:"neutral600"},a({id:"global.users",defaultMessage:"Users"}))),e.createElement(v.Th,null,e.createElement(G.T,null,a({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(J.p,null,i?.map((m,b)=>e.createElement(ae,{key:m.id,id:m.id,name:m.name,description:m.description,usersCount:m.usersCount,icons:d(m),rowIndex:b+2,canUpdate:u})))),!y&&!h&&e.createElement(ee,null)),e.createElement(n.QH,{isOpen:D,onConfirm:p,isConfirmButtonLoading:T,onToggleDialog:A}))},me=()=>e.createElement(n.O4,{permissions:f.Z.settings.roles.main},e.createElement(ue,null))},99223:function(N,M,t){t.d(M,{Z:function(){return f}});var e=t(74512),n=t(87933);const f=({startActions:x,endActions:O})=>!x&&!O?null:(0,e.jsxs)(n.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,e.jsx)(n.k,{gap:2,wrap:"wrap",children:x}),(0,e.jsx)(n.k,{gap:2,shrink:0,wrap:"wrap",children:O})]})},73269:function(N,M,t){t.d(M,{c:function(){return U}});var e=t(74512),n=t(8471),f=t(72850),x=t(9026),O=t(87933),W=t(49372);const j=(0,n.ZP)(f.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:g})=>g.colors.primary600};
  }
`,B=(0,n.ZP)(f.x)`
  border-radius: 0 0 ${({theme:g})=>g.borderRadius} ${({theme:g})=>g.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,U=({children:g,icon:S,...F})=>(0,e.jsxs)("div",{children:[(0,e.jsx)(x.i,{}),(0,e.jsx)(B,{as:"button",background:"primary100",padding:5,...F,children:(0,e.jsxs)(O.k,{children:[(0,e.jsx)(j,{"aria-hidden":!0,background:"primary200",children:S}),(0,e.jsx)(f.x,{paddingLeft:3,children:(0,e.jsx)(W.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:g})})]})})]})}}]);
