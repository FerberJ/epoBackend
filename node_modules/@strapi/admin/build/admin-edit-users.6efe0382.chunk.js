"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[4263],{19150:function(I,o,e){e.d(o,{R:function(){return d}});var t=e(20108),a=e(69262),s=e(33348);function d(r={},p={}){const{id:n="",...i}=r,c=(0,s.stringify)(i,{encode:!1}),{get:m}=(0,a.kY)(),{data:l,isError:f,isLoading:U,refetch:C}=(0,t.useQuery)(["users",n,i],async()=>{const{data:{data:h}}=await m(`/admin/users/${n}${c?`?${c}`:""}`);return h},p);let M=[];return n&&l?M=[l]:Array.isArray(l?.results)&&(M=l.results),{users:M,pagination:l?.pagination??null,isLoading:U,isError:f,refetch:C}}},40874:function(I,o,e){e.r(o),e.d(o,{default:function(){return se}});var t=e(32735),a=e(69262),s=e(53038),d=e(83983),r=e(20011),p=e(67879),n=e(60216),i=e.n(n),c=e(88423),m=e.n(c),l=e(33795),f=e.n(l),U=e(9086),C=e.n(U),M=e(92802),h=e(27649),D=e(82055),_=e(41415),$=e(17e3),K=e(72850),S=e(87933),O=e(49372),w=e(15335),j=e(5803),N=e(66456),Y=e(29439),x=e(8997);const v=async(R,T)=>{const{put:u}=(0,a.tg)(),{data:P}=await u(`/admin/users/${R}`,T);return P.data};var J=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]],k=e(1057),q=e(4397),ee=e(19150);const te=(()=>window&&window.strapi&&window.strapi.isEE?e(28890).Z:e(16325).Z)(),V=["email","firstname","lastname","username","isActive","roles"],G=R=>{let{canUpdate:T}=R;const{formatMessage:u}=(0,p.Z)(),{params:{id:P}}=(0,s.$B)("/settings/users/:id"),{push:B}=(0,s.k6)(),{setUserDisplayName:b}=(0,a.L7)(),Z=(0,a.lm)(),{lockApp:ne,unlockApp:re}=(0,a.o1)();(0,a.go)();const{users:[z],isLoading:Q}=(0,ee.R)({id:P},{onError(g){const{status:E}=g.response;E===403?(Z({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),B("/")):Z({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),oe=async(g,E)=>{ne();try{const y=await v(P,C()(g,"confirmPassword"));Z({type:"success",message:u({id:"notification.success.saved",defaultMessage:"Saved"})});const L=a.I8.getUserInfo();if(P.toString()===L.id.toString()){a.I8.setUserInfo(y);const W=f()(g,"username")||(0,x.Pp)(g.firstname,g.lastname);b(W)}E.setValues(m()(g,V))}catch(y){const L=(0,x.Iz)(y.response.data),W=Object.keys(L).reduce((H,A)=>(H[A]=L[A].id,H),{});E.setErrors(W),Z({type:"warning",message:f()(y,"response.data.error.message","notification.error")})}re()},ie=Q?{id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}:{id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},F=Object.keys(m()(z,V)).reduce((g,E)=>E==="roles"?(g[E]=(z?.roles||[]).map(y=>{let{id:L}=y;return L}),g):(g[E]=z?.[E],g),{}),le=F.username||(0,x.Pp)(F.firstname,F.lastname),X=u(ie,{name:le});return Q?t.createElement(h.o,{"aria-busy":"true"},t.createElement(a.SL,{name:"Users"}),t.createElement(D.T,{primaryAction:t.createElement(_.z,{disabled:!0,startIcon:t.createElement(N.Z,null),type:"button",size:"L"},u({id:"global.save",defaultMessage:"Save"})),title:X,navigationAction:t.createElement(a.rU,{startIcon:t.createElement(Y.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},u({id:"global.back",defaultMessage:"Back"}))}),t.createElement($.D,null,t.createElement(a.dO,null))):t.createElement(h.o,null,t.createElement(a.SL,{name:"Users"}),t.createElement(M.J9,{onSubmit:oe,initialValues:F,validateOnChange:!1,validationSchema:k.YM},g=>{let{errors:E,values:y,handleChange:L,isSubmitting:W}=g;return t.createElement(a.l0,null,t.createElement(D.T,{primaryAction:t.createElement(_.z,{disabled:W||!T,startIcon:t.createElement(N.Z,null),loading:W,type:"submit",size:"L"},u({id:"global.save",defaultMessage:"Save"})),title:X,navigationAction:t.createElement(a.rU,{startIcon:t.createElement(Y.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},u({id:"global.back",defaultMessage:"Back"}))}),t.createElement($.D,null,z?.registrationToken&&t.createElement(K.x,{paddingBottom:6},t.createElement(te,{registrationToken:z.registrationToken})),t.createElement(S.k,{direction:"column",alignItems:"stretch",gap:7},t.createElement(K.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(S.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(O.Z,{variant:"delta",as:"h2"},u({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})),t.createElement(w.r,{gap:5},J.map(H=>H.map(A=>t.createElement(j.P,(0,r.Z)({key:A.name},A.size),t.createElement(a.jm,(0,r.Z)({},A,{disabled:!T,error:E[A.name],onChange:L,value:y[A.name]||""})))))))),t.createElement(K.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(S.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(O.Z,{variant:"delta",as:"h2"},u({id:"global.roles",defaultMessage:"User's role"})),t.createElement(w.r,{gap:5},t.createElement(j.P,{col:6,xs:12},t.createElement(q.Z,{disabled:!T,error:E.roles,onChange:L,value:y.roles}))))))))}))};G.propTypes={canUpdate:i().bool.isRequired};var ae=G,se=()=>{const R=(0,a.lm)(),T=(0,t.useMemo)(()=>({read:d.Z.settings.users.read,update:d.Z.settings.users.update}),[]),{isLoading:u,allowedActions:{canRead:P,canUpdate:B}}=(0,a.ss)(T),{state:b}=(0,s.TH)(),Z=b?.from??"/";return(0,t.useEffect)(()=>{u||!P&&!B&&R({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[u,P,B,R]),u?t.createElement(a.dO,null):!P&&!B?t.createElement(s.l_,{to:Z}):t.createElement(ae,{canUpdate:B})}},76779:function(I,o,e){var t=e(32735),a=e(60216),s=e.n(a),d=e(50563),r=e(69262),p=e(47765),n=e(67879);const i=({children:c,target:m})=>{const l=(0,r.lm)(),{formatMessage:f}=(0,n.Z)(),{copy:U}=(0,r.VP)(),C=f({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),M=async()=>{await U(m)&&l({type:"info",message:{id:"notification.link-copied"}})};return t.createElement(r.Y_,{endAction:t.createElement(d.h,{label:C,noBorder:!0,icon:t.createElement(p.Z,null),onClick:M}),title:m,titleEllipsis:!0,subtitle:c,icon:t.createElement("span",{style:{fontSize:32}},"\u2709\uFE0F"),iconBackground:"neutral100"})};i.propTypes={children:s().oneOfType([s().element,s().string]).isRequired,target:s().string.isRequired},o.Z=i},16325:function(I,o,e){var t=e(32735),a=e(67879),s=e(60216),d=e.n(s),r=e(78246),p=e(76779);const n=({registrationToken:i})=>{const{formatMessage:c}=(0,a.Z)(),m=`${window.location.origin}${r.Z}auth/register?registrationToken=${i}`;return t.createElement(p.Z,{target:m},c({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};n.defaultProps={registrationToken:""},n.propTypes={registrationToken:d().string},o.Z=n},4397:function(I,o,e){var t=e(32735),a=e(60216),s=e.n(a),d=e(67879),r=e(68465),p=e(84967),n=e(20108),i=e(8471),c=e(27169),m=e(69262);const l=i.F4`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,f=i.ZP.div`
  animation: ${l} 2s infinite linear;
`,U=()=>t.createElement(f,null,t.createElement(c.Z,null)),C=async()=>{const{get:h}=(0,m.tg)(),{data:D}=await h("/admin/roles");return D.data},M=({disabled:h,error:D,onChange:_,value:$})=>{const{status:K,data:S}=(0,n.useQuery)(["roles"],C,{staleTime:5e4}),{formatMessage:O}=(0,d.Z)(),w=D?O({id:D,defaultMessage:D}):"",j=O({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),N=O({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),Y=O({id:"app.components.Select.placeholder",defaultMessage:"Select"}),x=K==="loading"?t.createElement(U,null):void 0;return t.createElement(r.P,{id:"roles",disabled:h,error:w,hint:N,label:j,name:"roles",onChange:v=>{_({target:{name:"roles",value:v}})},placeholder:Y,multi:!0,startIcon:x,value:$.map(v=>v.toString()),withTags:!0,required:!0},(S||[]).map(v=>t.createElement(p.W,{key:v.id,value:v.id.toString()},O({id:`global.${v.code}`,defaultMessage:v.name}))))};M.defaultProps={disabled:!1,error:void 0},M.propTypes={disabled:s().bool,error:s().string,onChange:s().func.isRequired,value:s().array.isRequired},o.Z=M},1057:function(I,o,e){e.d(o,{YM:function(){return c},Rw:function(){return r}});var t=e(24346),a=e(69262);const s={firstname:t.Z_().trim().required(a.I0.required),lastname:t.Z_(),email:t.Z_().email(a.I0.email).lowercase().required(a.I0.required),username:t.Z_().nullable(),password:t.Z_().min(8,a.I0.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:t.Z_().min(8,a.I0.minLength).oneOf([t.iH("password"),null],"components.Input.error.password.noMatch").when("password",(m,l)=>m?l.required(a.I0.required):l)};var r={...s,currentPassword:t.Z_().when(["password","confirmPassword"],(m,l,f)=>m||l?f.required(a.I0.required):f),preferedLanguage:t.Z_().nullable()},n={roles:t.IX().min(1,a.I0.required).required(a.I0.required)},c=t.Ry().shape({...s,isActive:t.Xg(),...n})},28890:function(I,o,e){var t=e(32735),a=e(67879),s=e(60216),d=e.n(s),r=e(78246),p=e(76779);const n=({registrationToken:i})=>{const{formatMessage:c}=(0,a.Z)();return i?t.createElement(p.Z,{target:`${window.location.origin}${r.Z}auth/register?registrationToken=${i}`},c({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})):t.createElement(p.Z,{target:`${window.location.origin}${r.Z}auth/login`},c({id:"app.components.Users.MagicLink.connect.sso",defaultMessage:"Send this link to the user, the first login can be made via a SSO provider."}))};n.defaultProps={registrationToken:""},n.propTypes={registrationToken:d().string},o.Z=n},29439:function(I,o,e){e.d(o,{Z:function(){return s}});var t=e(74512);const a=d=>(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...d,children:(0,t.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),s=a}}]);
