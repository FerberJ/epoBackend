"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[5199],{19150:function(p,n,e){e.d(n,{R:function(){return d}});var t=e(20108),a=e(69262),s=e(33348);function d(i={},u={}){const{id:o="",...c}=i,m=(0,s.stringify)(c,{encode:!1}),{get:E}=(0,a.kY)(),{data:l,isError:M,isLoading:h,refetch:D}=(0,t.useQuery)(["users",o,c],async()=>{const{data:{data:_}}=await E(`/admin/users/${o}${m?`?${m}`:""}`);return _},u);let r=[];return o&&l?r=[l]:Array.isArray(l?.results)&&(r=l.results),{users:r,pagination:l?.pagination??null,isLoading:h,isError:M,refetch:D}}},83119:function(p,n){const e=()=>null;n.Z=e},83196:function(p,n,e){var t=e(32735),a=e(60216),s=e.n(a),d=e(67879),i=e(72850),u=e(41415),o=e(5644),c=e(69262);const m=({displayedFilters:E})=>{const[l,M]=(0,t.useState)(!1),{formatMessage:h}=(0,d.Z)(),D=(0,t.useRef)(),r=()=>{M(_=>!_)};return t.createElement(t.Fragment,null,t.createElement(i.x,{paddingTop:1,paddingBottom:1},t.createElement(u.z,{variant:"tertiary",ref:D,startIcon:t.createElement(o.Z,null),onClick:r,size:"S"},h({id:"app.utils.filters",defaultMessage:"Filters"})),l&&t.createElement(c.J5,{displayedFilters:E,isVisible:l,onToggle:r,source:D})),t.createElement(c.W$,{filtersSchema:E}))};m.propTypes={displayedFilters:s().arrayOf(s().shape({name:s().string.isRequired,metadatas:s().shape({label:s().string}),fieldSchema:s().shape({type:s().string})})).isRequired},n.Z=m},9814:function(p,n,e){var t=e(32735),a=e(67879),s=e(60216),d=e.n(s),i=e(41415),u=e(7961);const o=({onClick:c})=>{const{formatMessage:m}=(0,a.Z)();return t.createElement(i.z,{onClick:c,startIcon:t.createElement(u.Z,null),size:"S"},m({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"}))};o.propTypes={onClick:d().func.isRequired},n.Z=o},60509:function(p,n){const e={firstname:"",lastname:"",email:"",roles:[]};n.Z=e},61358:function(p,n){const e=[];n.Z=e},10108:function(p,n,e){e.r(n),e.d(n,{default:function(){return Se}});var t=e(32735),a=e(69262),s=e(83983),d=e(33348),i=e.n(d),u=e(27649),o=e(82055),c=e(99223),m=e(17e3),E=e(53038),l=e(67879),M=e(20108),h=e(19150),D=e(60216),r=e.n(D),_=e(35658),L=e(94547),x=e(19786),z=e(82884),b=e(49372),F=e(87933),R=e(50563),U=e(72850),se=e(68625),ne=e(4038),J=e(8997);const G=({canDelete:f,headers:A,entriesToDelete:y,onClickDelete:$,onSelectRow:k,withMainAction:B,withBulkActions:O,rows:N})=>{const{push:H,location:{pathname:P}}=(0,E.k6)(),{formatMessage:S}=(0,l.Z)();return t.createElement(_.p,null,N.map(g=>{const W=y.findIndex(Z=>Z===g.id)!==-1;return t.createElement(L.Tr,{key:g.id,...(0,a.X7)({fn:()=>H(`${P}/${g.id}`),condition:O})},B&&t.createElement(x.Td,{...a.UW},t.createElement(z.C,{"aria-label":S({id:"app.component.table.select.one-entry",defaultMessage:"Select {target}"},{target:(0,J.Pp)(g.firstname,g.lastname)}),checked:W,onChange:()=>{k({name:g.id,value:!W})}})),A.map(({key:Z,cellFormatter:j,name:K,...V})=>t.createElement(x.Td,{key:Z},typeof j=="function"?j(g,{key:Z,name:K,formatMessage:S,...V}):t.createElement(b.Z,{textColor:"neutral800"},g[K]||"-"))),O&&t.createElement(x.Td,null,t.createElement(F.k,{justifyContent:"end"},t.createElement(R.h,{onClick:()=>H(`${P}/${g.id}`),label:S({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:(0,J.Pp)(g.firstname,g.lastname)}),noBorder:!0,icon:t.createElement(se.Z,null)}),f&&t.createElement(U.x,{paddingLeft:1,...a.UW},t.createElement(R.h,{onClick:()=>$(g.id),label:S({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:(0,J.Pp)(g.firstname,g.lastname)}),noBorder:!0,icon:t.createElement(ne.Z,null)})))))}))};G.defaultProps={canDelete:!1,entriesToDelete:[],onClickDelete(){},onSelectRow(){},rows:[],withBulkActions:!1,withMainAction:!1},G.propTypes={canDelete:r().bool,entriesToDelete:r().array,headers:r().array.isRequired,onClickDelete:r().func,onSelectRow:r().func,rows:r().array,withBulkActions:r().bool,withMainAction:r().bool};var C=G,Ee=e(83196),te=e(20011),re=e(41415),ge=e(85025),pe=e(55225),de=e(11299),Me=e(31600),ce=e(15335),le=e(5803),fe=e(11406),Pe=e(92802),ve=e(4397),he=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0}]],X=e(24346),De=X.Ry().shape({firstname:X.Z_().trim().required(a.I0.required),lastname:X.Z_(),email:X.Z_().email(a.I0.email).required(a.I0.required),roles:X.IX().min(1,a.I0.required).required(a.I0.required)}),_e={create:{buttonSubmitLabel:{id:"app.containers.Users.ModalForm.footer.button-success",defaultMessage:"Invite user"},isDisabled:!1,next:"magic-link"},"magic-link":{buttonSubmitLabel:{id:"global.finish",defaultMessage:"Finish"},isDisabled:!0,next:null}};const Oe=(()=>window&&window.strapi&&window.strapi.isEE?e(64746).Z:e(60509).Z)(),ye=(()=>window&&window.strapi&&window.strapi.isEE?e(43116).Z:e(61358).Z)(),Ce=(()=>window&&window.strapi&&window.strapi.isEE?e(28890).Z:e(16325).Z)(),me=f=>{let{onSuccess:A,onToggle:y}=f;const[$,k]=(0,t.useState)("create"),[B,O]=(0,t.useState)(!1),[N,H]=(0,t.useState)(null),{formatMessage:P}=(0,l.Z)(),S=(0,a.lm)(),{lockApp:g,unlockApp:W}=(0,a.o1)(),{post:Z}=(0,a.kY)(),j=(0,M.useMutation)(I=>Z("/admin/users",I),{async onSuccess(I){let{data:Y}=I;H(Y.data.registrationToken),await A(),ae(),O(!1)},onError(I){throw O(!1),S({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),I},onSettled(){W()}}),K=P({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"}),V=async(I,Y)=>{let{setErrors:ee}=Y;g(),O(!0);try{await j.mutateAsync(I)}catch(w){W(),w?.response?.data?.error.message==="Email already taken"&&ee({email:w.response.data.error.message})}},ae=()=>{v?k(v):y()},{buttonSubmitLabel:q,isDisabled:Q,next:v}=_e[$],We=$==="create"?t.createElement(re.z,{type:"submit",loading:B},P(q)):t.createElement(re.z,{type:"button",loading:B,onClick:y},P(q));return t.createElement(ge.P,{onClose:y,labelledBy:"title"},t.createElement(pe.x,null,t.createElement(de.O,{label:K},t.createElement(de.$,null,K))),t.createElement(Pe.J9,{initialValues:Oe,onSubmit:V,validationSchema:De,validateOnChange:!1},I=>{let{errors:Y,handleChange:ee,values:w}=I;return t.createElement(a.l0,null,t.createElement(Me.f,null,t.createElement(F.k,{direction:"column",alignItems:"stretch",gap:6},$!=="create"&&t.createElement(Ce,{registrationToken:N}),t.createElement(U.x,null,t.createElement(b.Z,{variant:"beta",as:"h2"},P({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"User details"})),t.createElement(U.x,{paddingTop:4},t.createElement(F.k,{direction:"column",alignItems:"stretch",gap:1},t.createElement(ce.r,{gap:5},he.map(ie=>ie.map(T=>t.createElement(le.P,(0,te.Z)({key:T.name},T.size),t.createElement(a.jm,(0,te.Z)({},T,{disabled:Q,error:Y[T.name],onChange:ee,value:w[T.name]}))))))))),t.createElement(U.x,null,t.createElement(b.Z,{variant:"beta",as:"h2"},P({id:"global.roles",defaultMessage:"User's role"})),t.createElement(U.x,{paddingTop:4},t.createElement(ce.r,{gap:5},t.createElement(le.P,{col:6,xs:12},t.createElement(ve.Z,{disabled:Q,error:Y.roles,onChange:ee,value:w.roles})),ye.map(ie=>ie.map(T=>t.createElement(le.P,(0,te.Z)({key:T.name},T.size),t.createElement(a.jm,(0,te.Z)({},T,{disabled:Q,onChange:ee,value:w[T.name]})))))))))),t.createElement(fe.m,{startActions:t.createElement(re.z,{variant:"tertiary",onClick:y,type:"button"},P({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:We}))}))};me.propTypes={onToggle:r().func.isRequired,onSuccess:r().func.isRequired};var Te=me;const oe=({pagination:f})=>t.createElement(U.x,{paddingTop:4},t.createElement(F.k,{alignItems:"flex-end",justifyContent:"space-between"},t.createElement(a.v4,null),t.createElement(a.tU,{pagination:f})));oe.defaultProps={pagination:{pageCount:0,pageSize:10,total:0}},oe.propTypes={pagination:r().shape({page:r().number,pageCount:r().number,pageSize:r().number,total:r().number})};var Le=oe,Ae=[{name:"firstname",metadatas:{label:"Firstname"},fieldSchema:{type:"string"}},{name:"lastname",metadatas:{label:"Lastname"},fieldSchema:{type:"string"}},{name:"email",metadatas:{label:"Email"},fieldSchema:{type:"email"}},{name:"username",metadatas:{label:"Username"},fieldSchema:{type:"string"}},{name:"isActive",metadatas:{label:"Active user"},fieldSchema:{type:"boolean"}}],Ie=[{name:"firstname",key:"firstname",metadatas:{label:{id:"Settings.permissions.users.firstname",defaultMessage:"Firstname"},sortable:!0}},{name:"lastname",key:"lastname",metadatas:{label:{id:"Settings.permissions.users.lastname",defaultMessage:"Lastname"},sortable:!0}},{key:"email",name:"email",metadatas:{label:{id:"Settings.permissions.users.email",defaultMessage:"Email"},sortable:!0}},{key:"roles",name:"roles",metadatas:{label:{id:"Settings.permissions.users.roles",defaultMessage:"Roles"},sortable:!1},cellFormatter({roles:f},{formatMessage:A}){return t.createElement(b.Z,{textColor:"neutral800"},f.map(y=>A({id:`Settings.permissions.users.${y.code}`,defaultMessage:y.name})).join(`,
`))}},{key:"username",name:"username",metadatas:{label:{id:"Settings.permissions.users.username",defaultMessage:"Username"},sortable:!0}},{key:"isActive",name:"isActive",metadatas:{label:{id:"Settings.permissions.users.user-status",defaultMessage:"User status"},sortable:!1},cellFormatter({isActive:f},{formatMessage:A}){return t.createElement(F.k,null,t.createElement(a.qb,{isActive:f,variant:f?"success":"danger"}),t.createElement(b.Z,{textColor:"neutral800"},A({id:f?"Settings.permissions.users.active":"Settings.permissions.users.inactive",defaultMessage:f?"Active":"Inactive"})))}}];const Re=(()=>window&&window.strapi&&window.strapi.isEE?e(99724).Z:e(9814).Z)(),Ue=(()=>window&&window.strapi&&window.strapi.isEE?e(21306).Z:e(83119).Z)(),ue=["ee","license-limit-info"];var Be=()=>{const{post:f}=(0,a.kY)(),{formatAPIError:A}=(0,a.So)(),[y,$]=(0,t.useState)(!1),{allowedActions:{canCreate:k,canDelete:B,canRead:O}}=(0,a.ss)(s.Z.settings.users),N=(0,M.useQueryClient)(),H=(0,a.lm)(),{formatMessage:P}=(0,l.Z)(),{search:S}=(0,E.TH)();(0,a.go)(),Ue();const{users:g,pagination:W,isError:Z,isLoading:j,refetch:K}=(0,h.R)(i().parse(S,{ignoreQueryPrefix:!0}),{enabled:O}),V=Ie.map(v=>({...v,metadatas:{...v.metadatas,label:P(v.metadatas.label)}})),ae=P({id:"global.users",defaultMessage:"Users"}),q=()=>{$(v=>!v)},Q=(0,M.useMutation)(async v=>{await f("/admin/users/batch-delete",{ids:v})},{async onSuccess(){await K(),await N.refetchQueries(ue)},onError(v){H({type:"warning",message:{id:"notification.error",message:A(v),defaultMessage:"An error occured"}})}});return t.createElement(u.o,{"aria-busy":j},t.createElement(a.SL,{name:"Users"}),t.createElement(o.T,{primaryAction:k&&t.createElement(Re,{onClick:q}),title:ae,subtitle:P({id:"Settings.permissions.users.listview.header.subtitle",defaultMessage:"All the users who have access to the Strapi admin panel"})}),O&&t.createElement(c.Z,{startActions:t.createElement(t.Fragment,null,t.createElement(a.m,{label:P({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:ae})}),t.createElement(Ee.Z,{displayedFilters:Ae}))}),t.createElement(m.D,{canRead:O},!O&&t.createElement(a.ZF,null),Z&&t.createElement("div",null,"TODO: An error occurred"),O&&t.createElement(t.Fragment,null,t.createElement(a.tM,{contentType:"Users",isLoading:j,onConfirmDeleteAll:Q.mutateAsync,onConfirmDelete:v=>Q.mutateAsync([v]),headers:V,rows:g,withBulkActions:!0,withMainAction:B},t.createElement(C,{canDelete:B,headers:V,rows:g,withBulkActions:!0,withMainAction:B})),W&&t.createElement(Le,{pagination:W}))),y&&t.createElement(Te,{onSuccess:async()=>{await K(),await N.refetchQueries(ue)},onToggle:q}))},Se=()=>t.createElement(a.O4,{permissions:s.Z.settings.users.main},t.createElement(Be,null))},76779:function(p,n,e){var t=e(32735),a=e(60216),s=e.n(a),d=e(50563),i=e(69262),u=e(47765),o=e(67879);const c=({children:m,target:E})=>{const l=(0,i.lm)(),{formatMessage:M}=(0,o.Z)(),{copy:h}=(0,i.VP)(),D=M({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),r=async()=>{await h(E)&&l({type:"info",message:{id:"notification.link-copied"}})};return t.createElement(i.Y_,{endAction:t.createElement(d.h,{label:D,noBorder:!0,icon:t.createElement(u.Z,null),onClick:r}),title:E,titleEllipsis:!0,subtitle:m,icon:t.createElement("span",{style:{fontSize:32}},"\u2709\uFE0F"),iconBackground:"neutral100"})};c.propTypes={children:s().oneOfType([s().element,s().string]).isRequired,target:s().string.isRequired},n.Z=c},16325:function(p,n,e){var t=e(32735),a=e(67879),s=e(60216),d=e.n(s),i=e(78246),u=e(76779);const o=({registrationToken:c})=>{const{formatMessage:m}=(0,a.Z)(),E=`${window.location.origin}${i.Z}auth/register?registrationToken=${c}`;return t.createElement(u.Z,{target:E},m({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};o.defaultProps={registrationToken:""},o.propTypes={registrationToken:d().string},n.Z=o},4397:function(p,n,e){var t=e(32735),a=e(60216),s=e.n(a),d=e(67879),i=e(68465),u=e(84967),o=e(20108),c=e(8471),m=e(27169),E=e(69262);const l=c.F4`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,M=c.ZP.div`
  animation: ${l} 2s infinite linear;
`,h=()=>t.createElement(M,null,t.createElement(m.Z,null)),D=async()=>{const{get:_}=(0,E.tg)(),{data:L}=await _("/admin/roles");return L.data},r=({disabled:_,error:L,onChange:x,value:z})=>{const{status:b,data:F}=(0,o.useQuery)(["roles"],D,{staleTime:5e4}),{formatMessage:R}=(0,d.Z)(),U=L?R({id:L,defaultMessage:L}):"",se=R({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),ne=R({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),J=R({id:"app.components.Select.placeholder",defaultMessage:"Select"}),G=b==="loading"?t.createElement(h,null):void 0;return t.createElement(i.P,{id:"roles",disabled:_,error:U,hint:ne,label:se,name:"roles",onChange:C=>{x({target:{name:"roles",value:C}})},placeholder:J,multi:!0,startIcon:G,value:z.map(C=>C.toString()),withTags:!0,required:!0},(F||[]).map(C=>t.createElement(u.W,{key:C.id,value:C.id.toString()},R({id:`global.${C.code}`,defaultMessage:C.name}))))};r.defaultProps={disabled:!1,error:void 0},r.propTypes={disabled:s().bool,error:s().string,onChange:s().func.isRequired,value:s().array.isRequired},n.Z=r},99724:function(p,n,e){var t=e(32735),a=e(67879),s=e(60216),d=e.n(s),i=e(87933),u=e(63919),o=e(99140),c=e(41415),m=e(69932),E=e(7961),l=e(36866),M=e.n(l),h=e(58414);const D=({onClick:r})=>{const{formatMessage:_}=(0,a.Z)(),{license:L}=(0,h.q5)(),{permittedSeats:x,shouldStopCreate:z}=L?.data??{};return t.createElement(i.k,{gap:2},!M()(x)&&z&&t.createElement(u.u,{description:_({id:"Settings.application.admin-seats.at-limit-tooltip",defaultMessage:"At limit: add seats to invite more users"}),position:"left"},t.createElement(o.J,{width:`${14/16}rem`,height:`${14/16}rem`,color:"danger500",as:m.Z})),t.createElement(c.z,{"data-testid":"create-user-button",onClick:r,startIcon:t.createElement(E.Z,null),size:"S",disabled:z},_({id:"Settings.permissions.users.create",defaultMessage:"Invite new user"})))};D.propTypes={onClick:d().func.isRequired},n.Z=D},64746:function(p,n,e){var t=e(60509);const a=window.strapi.features.isEnabled(window.strapi.features.SSO)?{useSSORegistration:!0}:{},s={...t.Z,...a};n.Z=s},43116:function(p,n){const e=window.strapi.features.isEnabled(window.strapi.features.SSO)?[[{intlLabel:{id:"Settings.permissions.users.form.sso",defaultMessage:"Connect with SSO"},hint:{id:"Settings.permissions.users.form.sso.description",defaultMessage:"When enabled (ON), users can login via SSO"},name:"useSSORegistration",type:"bool",size:{col:6,xs:12}}]]:[];n.Z=e},28890:function(p,n,e){var t=e(32735),a=e(67879),s=e(60216),d=e.n(s),i=e(78246),u=e(76779);const o=({registrationToken:c})=>{const{formatMessage:m}=(0,a.Z)();return c?t.createElement(u.Z,{target:`${window.location.origin}${i.Z}auth/register?registrationToken=${c}`},m({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})):t.createElement(u.Z,{target:`${window.location.origin}${i.Z}auth/login`},m({id:"app.components.Users.MagicLink.connect.sso",defaultMessage:"Send this link to the user, the first login can be made via a SSO provider."}))};o.defaultProps={registrationToken:""},o.propTypes={registrationToken:d().string},n.Z=o},11299:function(p,n,e){e.d(n,{$:function(){return m},O:function(){return E}});var t=e(74512),a=e(77277),s=e(8471),d=e(3685),i=e(87933),u=e(72850),o=e(49372);const c=(0,s.ZP)(i.k)`
  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
    path {
      fill: ${({theme:l})=>l.colors.neutral500};
    }
  }
  :last-of-type ${u.x} {
    display: none;
  }
  :last-of-type ${o.Z} {
    color: ${({theme:l})=>l.colors.neutral800};
    font-weight: ${({theme:l})=>l.fontWeights.bold};
  }
`,m=({children:l})=>(0,t.jsxs)(c,{inline:!0,as:"li",children:[(0,t.jsx)(o.Z,{variant:"pi",textColor:"neutral600",children:l}),(0,t.jsx)(u.x,{"aria-hidden":!0,paddingLeft:3,paddingRight:3,children:(0,t.jsx)(a.Z,{})})]});m.displayName="Crumb";const E=({children:l,label:M,...h})=>(0,t.jsxs)(i.k,{...h,children:[(0,t.jsx)(d.T,{children:M}),(0,t.jsx)("ol",{"aria-hidden":!0,children:l})]});E.displayName="Breadcrumbs"},99223:function(p,n,e){e.d(n,{Z:function(){return s}});var t=e(74512),a=e(87933);const s=({startActions:d,endActions:i})=>!d&&!i?null:(0,t.jsxs)(a.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,t.jsx)(a.k,{gap:2,wrap:"wrap",children:d}),(0,t.jsx)(a.k,{gap:2,shrink:0,wrap:"wrap",children:i})]})},7961:function(p,n,e){e.d(n,{Z:function(){return s}});var t=e(74512);const a=d=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...d,children:[(0,t.jsx)("path",{fill:"#32324D",d:"M0 2.8A.8.8 0 0 1 .8 2h22.4a.8.8 0 0 1 .8.8v2.71a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V2.8Z"}),(0,t.jsx)("path",{fill:"#32324D",d:"M1.922 7.991C.197 6.675 0 6.252 0 5.289h23.953c.305 1.363-1.594 2.506-2.297 3.125-1.953 1.363-6.253 4.36-7.828 5.45-1.575 1.09-3.031.455-3.562 0-2.063-1.41-6.62-4.557-8.344-5.873ZM22.8 18H1.2c-.663 0-1.2.471-1.2 1.053v1.894C0 21.529.537 22 1.2 22h21.6c.663 0 1.2-.471 1.2-1.053v-1.894c0-.582-.537-1.053-1.2-1.053Z"}),(0,t.jsx)("path",{fill:"#32324D",d:"M0 9.555v10.972h24V9.554c-2.633 1.95-8.367 6.113-9.96 7.166-1.595 1.052-3.352.438-4.032 0L0 9.555Z"})]}),s=a}}]);
